<!DOCTYPE html>
<html>
<head>
  <title>Oracle Cloud Infrastructure - Resource: oci_data_safe_security_assessment</title>
  <meta name="GENERATOR" content="Generated from terraform-provider-oci markdown documentation">
  <meta charset="utf-8">
  <link rel="stylesheet" type="text/css" href="../../css/style.css">
</head>
<body>

	<div class="nav_wrap">
		<iframe id ="nav_list" src="../../toc.html"></iframe>
	</div>

	<div class="main" tabindex="-1">
<h1>oci_data_safe_security_assessment</h1>

<p>This resource provides the Security Assessment resource in Oracle Cloud Infrastructure Data Safe service.
Api doc link for the resource: <a href="https://docs.oracle.com/iaas/api/#/en/data-safe/latest/SecurityAssessment">https://docs.oracle.com/iaas/api/#/en/data-safe/latest/SecurityAssessment</a></p>

<p>Example terraform configs related to the resource : <a href="https://github.com/oracle/terraform-provider-oci/tree/master/examples/datasafe">https://github.com/oracle/terraform-provider-oci/tree/master/examples/datasafe</a></p>

<p>Creates a new saved security assessment for one or multiple targets in a compartment. When this operation is performed,
it will save the latest assessments in the specified compartment. If a schedule is passed, it will persist the latest assessments,
at the defined date and time, in the format defined by <a href="https://tools.ietf.org/html/rfc3339">RFC3339</a>.</p>

<h2>Example Usage</h2>

<pre><code class="language-hcl">resource &quot;oci_data_safe_security_assessment&quot; &quot;test_security_assessment&quot; {
	#Required
	compartment_id = var.compartment_id

	#Optional
	base_security_assessment_id = oci_data_safe_security_assessment.test_security_assessment.id
	defined_tags = {&quot;Operations.CostCenter&quot;= &quot;42&quot;}
	description = var.security_assessment_description
	display_name = var.security_assessment_display_name
	freeform_tags = {&quot;Department&quot;= &quot;Finance&quot;}
	is_assessment_scheduled = var.security_assessment_is_assessment_scheduled
	schedule = var.security_assessment_schedule
	target_id = oci_cloud_guard_target.test_target.id
	target_type = var.security_assessment_target_type
	template_assessment_id = oci_data_safe_template_assessment.test_template_assessment.id
	type = var.security_assessment_type
}
</code></pre>

<h2>Argument Reference</h2>

<p>The following arguments are supported:</p>

<ul>
<li><p><code>base_security_assessment_id</code> - (Optional) The OCID of the security assessment. The assessment should be of type SAVED.  It will be required while creating the template baseline assessment for individual targets to fetch the detailed information from an existing security assessment.</p></li>

<li><p><code>compartment_id</code> - (Required) (Updatable) The OCID of the compartment that contains the security assessment.</p></li>

<li><p><code>defined_tags</code> - (Optional) (Updatable) Defined tags for this resource. Each key is predefined and scoped to a namespace. For more information, see <a href="https://docs.cloud.oracle.com/iaas/Content/General/Concepts/resourcetags.htm">Resource Tags</a> Example: <code>{&quot;Operations.CostCenter&quot;: &quot;42&quot;}</code></p></li>

<li><p><code>description</code> - (Optional) (Updatable) Description of the security assessment.</p></li>

<li><p><code>display_name</code> - (Optional) (Updatable) The display name of the security assessment.</p></li>

<li><p><code>freeform_tags</code> - (Optional) (Updatable) Free-form tags for this resource. Each tag is a simple key-value pair with no predefined name, type, or namespace. For more information, see <a href="https://docs.cloud.oracle.com/iaas/Content/General/Concepts/resourcetags.htm">Resource Tags</a>  Example: <code>{&quot;Department&quot;: &quot;Finance&quot;}</code></p></li>

<li><p><code>is_assessment_scheduled</code> - (Optional) (Updatable) Indicates whether the assessment is scheduled to run.</p></li>

<li><p><code>schedule</code> - (Optional) (Updatable) To schedule the assessment for running periodically, specify the schedule in this attribute. Create or schedule one assessment per compartment. If not defined, the assessment runs immediately. Format - <version-string>;<version-specific-schedule></p>

<p>Allowed version strings - &ldquo;v1&rdquo; v1&rsquo;s version specific schedule -<ss> <mm> <hh> <day-of-week> <day-of-month> Each of the above fields potentially introduce constraints. A workrequest is created only when clock time satisfies all the constraints. Constraints introduced: 1. seconds = <ss> (So, the allowed range for <ss> is [0, 59]) 2. minutes = <mm> (So, the allowed range for <mm> is [0, 59]) 3. hours = <hh> (So, the allowed range for <hh> is [0, 23]) <day-of-week> can be either &lsquo;<em>&rsquo; (without quotes or a number between 1(Monday) and 7(Sunday)) 4. No constraint introduced when it is &lsquo;</em>&rsquo;. When not, day of week must equal the given value <day-of-month> can be either &lsquo;<em>&rsquo; (without quotes or a number between 1 and 28) 5. No constraint introduced when it is &lsquo;</em>&rsquo;. When not, day of month must equal the given value</p></li>

<li><p><code>target_id</code> - (Optional) The OCID of the target database or target database group on which security assessment is to be run.</p></li>

<li><p><code>target_type</code> - (Optional) The type of security assessment resource whether it is individual or group resource. For individual target use type TARGET_DATABASE and for group resource use type TARGET_DATABASE_GROUP. If not provided, TARGET_DATABASE would be used as default value.</p></li>

<li><p><code>template_assessment_id</code> - (Optional) The OCID of the template assessment. It will be required while creating the template baseline assessment.</p></li>

<li><p><code>type</code> - (Optional) The type of the security assessment</p></li>

<li><p><code>apply_template_trigger</code> - (Optional) (Updatable) An optional property when incremented triggers Apply Template. Could be set to any integer value.</p></li>

<li><p><code>compare_to_template_baseline_trigger</code> - (Optional) (Updatable) An optional property when incremented triggers Compare To Template Baseline. Could be set to any integer value.</p></li>

<li><p><code>remove_template_trigger</code> - (Optional) (Updatable) An optional property when incremented triggers Remove Template. Could be set to any integer value.</p></li>
</ul>

<p>** IMPORTANT **
Any change to a property that does not support update will force the destruction and recreation of the resource with the new property values</p>

<h2>Attributes Reference</h2>

<p>The following attributes are exported:</p>

<ul>
<li><p><code>baseline_assessment_id</code> - The ocid of a security assessment which is of type TEMPLATE_BASELINE, this will be null or empty when type is TEMPLATE_BASELINE.</p></li>

<li><p><code>checks</code> - The security checks to be evaluated for type template.</p>

<ul>
<li><code>category</code> - The category to which the check belongs to.</li>
<li><code>key</code> - A unique identifier for the check.</li>
<li><code>oneline</code> - Provides a recommended approach to take to remediate the check reported.</li>
<li><code>references</code> - Provides information on whether the check is related to a CIS Oracle Database Benchmark recommendation, STIG rule, GDPR Article/Recital or related to the Oracle Best Practice.

<ul>
<li><code>cis</code> - Relevant section from CIS.</li>
<li><code>gdpr</code> - Relevant section from GDPR.</li>
<li><code>obp</code> - Relevant section from OBP.</li>
<li><code>stig</code> - Relevant section from STIG.</li>
</ul></li>
<li><code>remarks</code> - The explanation of the issue in this check. It explains the reason for the rule and, if a risk is reported, it may also explain the recommended actions for remediation.</li>
<li><code>suggested_severity</code> - The severity of the check as suggested by Data Safe security assessment. This will be the default severity in the template baseline security assessment.</li>
<li><code>title</code> - The short title for the check.</li>
</ul></li>

<li><p><code>compartment_id</code> - The OCID of the compartment that contains the security assessment.</p></li>

<li><p><code>defined_tags</code> - Defined tags for this resource. Each key is predefined and scoped to a namespace. For more information, see <a href="https://docs.cloud.oracle.com/iaas/Content/General/Concepts/resourcetags.htm">Resource Tags</a> Example: <code>{&quot;Operations.CostCenter&quot;: &quot;42&quot;}</code></p></li>

<li><p><code>description</code> - The description of the security assessment.</p></li>

<li><p><code>display_name</code> - The display name of the security assessment.</p></li>

<li><p><code>freeform_tags</code> - Free-form tags for this resource. Each tag is a simple key-value pair with no predefined name, type, or namespace. For more information, see <a href="https://docs.cloud.oracle.com/iaas/Content/General/Concepts/resourcetags.htm">Resource Tags</a>  Example: <code>{&quot;Department&quot;: &quot;Finance&quot;}</code></p></li>

<li><p><code>id</code> - The OCID of the security assessment.</p></li>

<li><p><code>ignored_assessment_ids</code> - List containing maps as values. Example: <code>{&quot;Operations&quot;: [ {&quot;CostCenter&quot;: &quot;42&quot;} ] }</code></p></li>

<li><p><code>ignored_targets</code> - List containing maps as values. Example: <code>{&quot;Operations&quot;: [ {&quot;CostCenter&quot;: &quot;42&quot;} ] }</code></p></li>

<li><p><code>is_assessment_scheduled</code> - Indicates whether the assessment is scheduled to run.</p></li>

<li><p><code>is_baseline</code> - Indicates whether or not the security assessment is set as a baseline. This is applicable only for saved security assessments.</p></li>

<li><p><code>is_deviated_from_baseline</code> - Indicates whether or not the security assessment deviates from the baseline.</p></li>

<li><p><code>last_compared_baseline_id</code> - The OCID of the baseline against which the latest security assessment was compared.</p></li>

<li><p><code>lifecycle_details</code> - Details about the current state of the security assessment.</p></li>

<li><p><code>link</code> - The summary of findings for the security assessment.</p></li>

<li><p><code>schedule</code> - Schedule of the assessment that runs periodically in the specified format: - <version-string>;<version-specific-schedule></p>

<p>Allowed version strings - &ldquo;v1&rdquo; v1&rsquo;s version specific schedule -<ss> <mm> <hh> <day-of-week> <day-of-month> Each of the above fields potentially introduce constraints. A workrequest is created only when clock time satisfies all the constraints. Constraints introduced: 1. seconds = <ss> (So, the allowed range for <ss> is [0, 59]) 2. minutes = <mm> (So, the allowed range for <mm> is [0, 59]) 3. hours = <hh> (So, the allowed range for <hh> is [0, 23]) <day-of-week> can be either &lsquo;<em>&rsquo; (without quotes or a number between 1(Monday) and 7(Sunday)) 4. No constraint introduced when it is &lsquo;</em>&rsquo;. When not, day of week must equal the given value <day-of-month> can be either &lsquo;<em>&rsquo; (without quotes or a number between 1 and 28) 5. No constraint introduced when it is &lsquo;</em>&rsquo;. When not, day of month must equal the given value</p></li>

<li><p><code>schedule_security_assessment_id</code> - The OCID of the security assessment that is responsible for creating this scheduled save assessment.</p></li>

<li><p><code>state</code> - The current state of the security assessment.</p></li>

<li><p><code>statistics</code> - Statistics showing the number of findings for each category grouped by risk levels for all the targets in the specified security assessment.</p>

<p>The categories include Auditing, Authorization Control, Data Encryption, Database Configuration, Fine-Grained Access Control, Privileges and Roles, and User Accounts. The risk levels include High Risk, Medium Risk, Low Risk, Advisory, Evaluate, and Pass.</p>

<ul>
<li><code>advisory</code> - Statistics showing the number of findings with a particular risk level for each category.

<ul>
<li><code>auditing_findings_count</code> - The number of findings in the Auditing category.</li>
<li><code>authorization_control_findings_count</code> - The number of findings in the Authorization Control category.</li>
<li><code>data_encryption_findings_count</code> - The number of findings in the Data Encryption category.</li>
<li><code>db_configuration_findings_count</code> - The number of findings in the Database Configuration category.</li>
<li><code>fine_grained_access_control_findings_count</code> - The number of findings in the Fine-Grained Access Control category.</li>
<li><code>privileges_and_roles_findings_count</code> - The number of findings in the Privileges and Roles category.</li>
<li><code>targets_count</code> - The number of targets that contributed to the counts at this risk level.</li>
<li><code>user_accounts_findings_count</code> - The number of findings in the User Accounts category.</li>
</ul></li>
<li><code>deferred</code> - Statistics showing the number of findings with a particular risk level for each category.

<ul>
<li><code>auditing_findings_count</code> - The number of findings in the Auditing category.</li>
<li><code>authorization_control_findings_count</code> - The number of findings in the Authorization Control category.</li>
<li><code>data_encryption_findings_count</code> - The number of findings in the Data Encryption category.</li>
<li><code>db_configuration_findings_count</code> - The number of findings in the Database Configuration category.</li>
<li><code>fine_grained_access_control_findings_count</code> - The number of findings in the Fine-Grained Access Control category.</li>
<li><code>privileges_and_roles_findings_count</code> - The number of findings in the Privileges and Roles category.</li>
<li><code>targets_count</code> - The number of targets that contributed to the counts at this risk level.</li>
<li><code>user_accounts_findings_count</code> - The number of findings in the User Accounts category.</li>
</ul></li>
<li><code>evaluate</code> - Statistics showing the number of findings with a particular risk level for each category.

<ul>
<li><code>auditing_findings_count</code> - The number of findings in the Auditing category.</li>
<li><code>authorization_control_findings_count</code> - The number of findings in the Authorization Control category.</li>
<li><code>data_encryption_findings_count</code> - The number of findings in the Data Encryption category.</li>
<li><code>db_configuration_findings_count</code> - The number of findings in the Database Configuration category.</li>
<li><code>fine_grained_access_control_findings_count</code> - The number of findings in the Fine-Grained Access Control category.</li>
<li><code>privileges_and_roles_findings_count</code> - The number of findings in the Privileges and Roles category.</li>
<li><code>targets_count</code> - The number of targets that contributed to the counts at this risk level.</li>
<li><code>user_accounts_findings_count</code> - The number of findings in the User Accounts category.</li>
</ul></li>
<li><code>high_risk</code> - Statistics showing the number of findings with a particular risk level for each category.

<ul>
<li><code>auditing_findings_count</code> - The number of findings in the Auditing category.</li>
<li><code>authorization_control_findings_count</code> - The number of findings in the Authorization Control category.</li>
<li><code>data_encryption_findings_count</code> - The number of findings in the Data Encryption category.</li>
<li><code>db_configuration_findings_count</code> - The number of findings in the Database Configuration category.</li>
<li><code>fine_grained_access_control_findings_count</code> - The number of findings in the Fine-Grained Access Control category.</li>
<li><code>privileges_and_roles_findings_count</code> - The number of findings in the Privileges and Roles category.</li>
<li><code>targets_count</code> - The number of targets that contributed to the counts at this risk level.</li>
<li><code>user_accounts_findings_count</code> - The number of findings in the User Accounts category.</li>
</ul></li>
<li><code>low_risk</code> - Statistics showing the number of findings with a particular risk level for each category.

<ul>
<li><code>auditing_findings_count</code> - The number of findings in the Auditing category.</li>
<li><code>authorization_control_findings_count</code> - The number of findings in the Authorization Control category.</li>
<li><code>data_encryption_findings_count</code> - The number of findings in the Data Encryption category.</li>
<li><code>db_configuration_findings_count</code> - The number of findings in the Database Configuration category.</li>
<li><code>fine_grained_access_control_findings_count</code> - The number of findings in the Fine-Grained Access Control category.</li>
<li><code>privileges_and_roles_findings_count</code> - The number of findings in the Privileges and Roles category.</li>
<li><code>targets_count</code> - The number of targets that contributed to the counts at this risk level.</li>
<li><code>user_accounts_findings_count</code> - The number of findings in the User Accounts category.</li>
</ul></li>
<li><code>medium_risk</code> - Statistics showing the number of findings with a particular risk level for each category.

<ul>
<li><code>auditing_findings_count</code> - The number of findings in the Auditing category.</li>
<li><code>authorization_control_findings_count</code> - The number of findings in the Authorization Control category.</li>
<li><code>data_encryption_findings_count</code> - The number of findings in the Data Encryption category.</li>
<li><code>db_configuration_findings_count</code> - The number of findings in the Database Configuration category.</li>
<li><code>fine_grained_access_control_findings_count</code> - The number of findings in the Fine-Grained Access Control category.</li>
<li><code>privileges_and_roles_findings_count</code> - The number of findings in the Privileges and Roles category.</li>
<li><code>targets_count</code> - The number of targets that contributed to the counts at this risk level.</li>
<li><code>user_accounts_findings_count</code> - The number of findings in the User Accounts category.</li>
</ul></li>
<li><code>pass</code> - Statistics showing the number of findings with a particular risk level for each category.

<ul>
<li><code>auditing_findings_count</code> - The number of findings in the Auditing category.</li>
<li><code>authorization_control_findings_count</code> - The number of findings in the Authorization Control category.</li>
<li><code>data_encryption_findings_count</code> - The number of findings in the Data Encryption category.</li>
<li><code>db_configuration_findings_count</code> - The number of findings in the Database Configuration category.</li>
<li><code>fine_grained_access_control_findings_count</code> - The number of findings in the Fine-Grained Access Control category.</li>
<li><code>privileges_and_roles_findings_count</code> - The number of findings in the Privileges and Roles category.</li>
<li><code>targets_count</code> - The number of targets that contributed to the counts at this risk level.</li>
<li><code>user_accounts_findings_count</code> - The number of findings in the User Accounts category.</li>
</ul></li>
<li><code>targets_count</code> - The total number of targets in this security assessment.</li>
</ul></li>

<li><p><code>system_tags</code> - System tags for this resource. Each key is predefined and scoped to a namespace. For more information, see Resource Tags. Example: <code>{&quot;orcl-cloud.free-tier-retained&quot;: &quot;true&quot;}</code></p></li>

<li><p><code>target_database_group_id</code> - The OCID of the target database group that the group assessment is created for.</p></li>

<li><p><code>target_ids</code> - Array of database target OCIDs.</p></li>

<li><p><code>target_type</code> - Indicates whether the security assessment is for a target database or a target database group.</p></li>

<li><p><code>target_version</code> - The version of the target database.</p></li>

<li><p><code>template_assessment_id</code> - The ocid of a security assessment which is of type TEMPLATE, this will be null or empty when type is TEMPLATE.</p></li>

<li><p><code>time_created</code> - The date and time the security assessment was created, in the format defined by <a href="https://tools.ietf.org/html/rfc3339">RFC3339</a>.</p></li>

<li><p><code>time_last_assessed</code> - The date and time the security assessment was last executed, in the format defined by <a href="https://tools.ietf.org/html/rfc3339">RFC3339</a>.</p></li>

<li><p><code>time_updated</code> - The date and time the security assessment was last updated, in the format defined by <a href="https://tools.ietf.org/html/rfc3339">RFC3339</a>.</p></li>

<li><p><code>triggered_by</code> - Indicates whether the security assessment was created by system or by a user.</p></li>

<li><p><code>type</code> - The type of the security assessment. Possible values are:</p>

<p>LATEST: The most up-to-date assessment that is running automatically for a target. It is system generated. SAVED: A saved security assessment. LATEST assessments are always saved in order to maintain the history of runs. A SAVED assessment is also generated by a &lsquo;refresh&rsquo; action (triggered by the user). SAVE_SCHEDULE: The schedule for periodic saves of LATEST assessments. TEMPLATE: The security assessment contains the checks that the user would like to run. It is user defined. TEMPLATE_BASELINE: The security assessment contains the checks that the user would like to run, together with the max allowed severity. The max allowed severity can be defined by the user. COMPARTMENT: An automatically managed assessment type that stores all details of targets in one compartment. This type keeps an up-to-date assessment of all database risks in one compartment. It is automatically updated when the latest assessment or refresh action is executed. It is also automatically updated when a target is deleted or move to a different compartment.</p></li>
</ul>

<h2>Timeouts</h2>

<p>The <code>timeouts</code> block allows you to specify <a href="https://registry.terraform.io/providers/oracle/oci/latest/docs/guides/changing_timeouts">timeouts</a> for certain operations:
	* <code>create</code> - (Defaults to 20 minutes), when creating the Security Assessment
	* <code>update</code> - (Defaults to 20 minutes), when updating the Security Assessment
	* <code>delete</code> - (Defaults to 20 minutes), when destroying the Security Assessment</p>

<h2>Import</h2>

<p>SecurityAssessments can be imported using the <code>id</code>, e.g.</p>

<pre><code>$ terraform import oci_data_safe_security_assessment.test_security_assessment &quot;id&quot;
</code></pre>

	</div>

</body>
</html>
